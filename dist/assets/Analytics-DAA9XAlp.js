import{c as v,i as d,j as e,D as M,k,C as j,M as b,l as N}from"./index-CyHvHqSZ.js";import{f as h,B as T}from"./Button-D-SvA5Xw.js";import{T as y,S as p}from"./StatBadge-PKqH29IJ.js";import{C as f}from"./car-DJo79FXk.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=v("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=v("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function S(r){return r.map(i=>{const n=i.tasks||[],s=n.filter(l=>l.status==="closed").length,t=n.length,a=t>0?Math.round(s/t*100):0;return{id:i.id,eventName:i.eventName,date:i.date,percentage:a,completed:s,total:t}})}function z(r){const i={};return r.forEach(n=>{var s;if(((s=n.compensation)==null?void 0:s.status)==="paid"&&n.compensation.amount>0){const t=h(new Date(n.date),"MMM yyyy");i[t]=(i[t]||0)+n.compensation.amount}}),i}function L(r){let i=0,n=0,s=0;return r.forEach(t=>{var a;(a=t.compensation)!=null&&a.amount&&(i+=t.compensation.amount,t.compensation.status==="paid"?n+=t.compensation.amount:t.compensation.status==="pending"&&(s+=t.compensation.amount))}),{total:i,paid:n,pending:s,count:r.filter(t=>{var a;return(a=t.compensation)==null?void 0:a.amount}).length}}function E(r){let i=0,n=0;return r.forEach(s=>{i+=s.distance,n+=s.amount}),{totalDistance:Math.round(i*10)/10,totalAmount:Math.round(n*100)/100,count:r.length}}function R(r){const i=new Date;return{total:r.length,upcoming:r.filter(n=>new Date(n.date)>i).length,completed:r.filter(n=>n.status==="completed").length,confirmed:r.filter(n=>n.status==="confirmed").length,pending:r.filter(n=>n.status==="pending").length,cancelled:r.filter(n=>n.status==="cancelled").length}}function V(r){const i=new Date,n=r.flatMap(s=>s.tasks||[]);return{total:r.length,upcoming:r.filter(s=>new Date(s.date)>i).length,past:r.filter(s=>new Date(s.date)<=i).length,totalTasks:n.length,completedTasks:n.filter(s=>s.status==="closed").length,openTasks:n.filter(s=>s.status==="open").length}}function $(r,i=5){const n={};return r.forEach(s=>{var t;if((t=s.compensation)!=null&&t.amount&&s.compensation.status==="paid"){const a=s.venue.name;n[a]||(n[a]={name:a,total:0,count:0}),n[a].total+=s.compensation.amount,n[a].count+=1}}),Object.values(n).sort((s,t)=>t.total-s.total).slice(0,i)}function A(){const i=d(t=>t.rehearsals).slice().sort((t,a)=>new Date(a.date).getTime()-new Date(t.date).getTime()).slice(0,10),n=S(i).reverse(),s=n.length>0?Math.round(n.reduce((t,a)=>t+a.percentage,0)/n.length):0;return n.length===0?e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Rehearsal Completion"}),e.jsx("div",{className:"text-center py-8 text-foreground/50",children:"No rehearsals yet. Create your first one!"})]}):e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Rehearsal Completion"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(y,{size:16,className:"text-success"}),e.jsx("span",{className:"text-foreground/70",children:"Avg:"}),e.jsxs("span",{className:"font-semibold",children:[s,"%"]})]})]}),e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium truncate flex-1 mr-2",children:t.eventName}),e.jsx("span",{className:"text-foreground/50 text-xs mr-2",children:h(new Date(t.date),"MMM d")}),e.jsxs("span",{className:"font-semibold min-w-[3rem] text-right",children:[t.percentage,"%"]})]}),e.jsx("div",{className:"relative h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all ${t.percentage===100?"bg-success":t.percentage>=50?"bg-primary":"bg-warning"}`,style:{width:`${t.percentage}%`}})}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-foreground/50",children:[e.jsx(D,{size:12}),e.jsxs("span",{children:[t.completed," of ",t.total," tasks"]})]})]},t.id))})]})}function B(){const r=d(c=>c.gigs),i=d(c=>c.settings),n=z(r),s=L(r),t=Object.keys(n).slice(-6),a=t.map(c=>n[c]),l=Math.max(...a,1);return t.length===0?e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Earnings Trend"}),e.jsx("div",{className:"text-center py-8 text-foreground/50",children:"No earnings data yet. Complete some gigs!"})]}):e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Earnings Trend"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{size:16,className:"text-success"}),e.jsxs("span",{className:"font-semibold",children:[i.currency," ",s.paid.toLocaleString()]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-success/20 border border-success/30",children:[e.jsx("div",{className:"text-xs text-success/70 mb-1",children:"Paid"}),e.jsxs("div",{className:"font-semibold text-success",children:[i.currency," ",s.paid.toLocaleString()]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-warning/20 border border-warning/30",children:[e.jsx("div",{className:"text-xs text-warning/70 mb-1",children:"Pending"}),e.jsxs("div",{className:"font-semibold text-warning",children:[i.currency," ",s.pending.toLocaleString()]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-info/20 border border-info/30",children:[e.jsx("div",{className:"text-xs text-info/70 mb-1",children:"Total"}),e.jsxs("div",{className:"font-semibold text-info",children:[i.currency," ",s.total.toLocaleString()]})]})]}),e.jsx("div",{className:"space-y-4",children:t.map((c,g)=>{const x=a[g],u=x/l*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:c}),e.jsxs("span",{className:"font-semibold",children:[i.currency," ",x.toLocaleString()]})]}),e.jsx("div",{className:"relative h-3 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-success to-primary rounded-full transition-all",style:{width:`${u}%`}})})]},c)})}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-foreground/70",children:[s.count," paid gig",s.count!==1?"s":""]}),e.jsxs("span",{className:"flex items-center gap-1 text-success",children:[e.jsx(y,{size:14}),"Last 6 months"]})]})]})}function U(){const r=d(a=>a.mileageLogs||[]),i=d(a=>a.gigs),n=d(a=>a.settings),s=E(r),t=()=>{const a=["Date","Gig","Origin","Destination","Distance (mi)","Rate","Amount"],l=r.map(o=>{const m=i.find(w=>w.id===o.gigId);return[h(new Date(o.date),"yyyy-MM-dd"),(m==null?void 0:m.eventName)||(m==null?void 0:m.venue.name)||"Unknown",o.origin,o.destination,o.distance.toString(),o.rate.toString(),o.amount.toFixed(2)]}),c=[a,...l].map(o=>o.join(",")).join(`
`),g=new Blob([c],{type:"text/csv"}),x=URL.createObjectURL(g),u=document.createElement("a");u.href=x,u.download=`mileage-log-${h(new Date,"yyyy-MM-dd")}.csv`,u.click(),URL.revokeObjectURL(x)};return r.length===0?e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(f,{size:20}),"Mileage Ledger"]}),e.jsxs("div",{className:"text-center py-8 text-foreground/50",children:[e.jsx(f,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"No mileage logs yet."}),e.jsx("p",{className:"text-sm mt-1",children:"Mileage is calculated when you add gig venues."})]})]}):e.jsxs("div",{className:"p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(f,{size:20}),"Mileage Ledger"]}),e.jsxs(T,{variant:"secondary",size:"sm",onClick:t,children:[e.jsx(k,{size:14}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-primary/20 border border-primary/30",children:[e.jsx("div",{className:"text-xs text-primary/70 mb-1",children:"Total Distance"}),e.jsxs("div",{className:"text-2xl font-bold text-primary",children:[s.totalDistance.toLocaleString(),e.jsx("span",{className:"text-sm font-normal ml-1",children:"mi"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-success/20 border border-success/30",children:[e.jsx("div",{className:"text-xs text-success/70 mb-1",children:"Total Reimbursement"}),e.jsxs("div",{className:"text-2xl font-bold text-success",children:[n.currency," ",s.totalAmount.toLocaleString()]})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"text-left py-3 px-2 font-medium text-foreground/70",children:"Date"}),e.jsx("th",{className:"text-left py-3 px-2 font-medium text-foreground/70",children:"Gig"}),e.jsx("th",{className:"text-left py-3 px-2 font-medium text-foreground/70",children:"Route"}),e.jsx("th",{className:"text-right py-3 px-2 font-medium text-foreground/70",children:"Distance"}),e.jsx("th",{className:"text-right py-3 px-2 font-medium text-foreground/70",children:"Amount"})]})}),e.jsx("tbody",{children:r.map(a=>{const l=i.find(c=>c.id===a.gigId);return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsx("td",{className:"py-3 px-2",children:h(new Date(a.date),"MMM d, yyyy")}),e.jsx("td",{className:"py-3 px-2",children:e.jsx("div",{className:"font-medium",children:(l==null?void 0:l.eventName)||(l==null?void 0:l.venue.name)||"Unknown"})}),e.jsx("td",{className:"py-3 px-2",children:e.jsxs("div",{className:"flex items-start gap-1 text-foreground/70",children:[e.jsx(C,{size:12,className:"mt-1 flex-shrink-0"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"truncate max-w-xs",children:a.origin}),e.jsxs("div",{className:"truncate max-w-xs",children:["â†’ ",a.destination]})]})]})}),e.jsxs("td",{className:"py-3 px-2 text-right tabular-nums",children:[a.distance.toFixed(1)," mi"]}),e.jsxs("td",{className:"py-3 px-2 text-right font-medium tabular-nums",children:[n.currency," ",a.amount.toFixed(2)]})]},a.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"border-t-2 border-white/20 font-semibold",children:[e.jsxs("td",{colSpan:3,className:"py-3 px-2",children:["Total (",s.count," trip",s.count!==1?"s":"",")"]}),e.jsxs("td",{className:"py-3 px-2 text-right tabular-nums",children:[s.totalDistance.toFixed(1)," mi"]}),e.jsxs("td",{className:"py-3 px-2 text-right tabular-nums",children:[n.currency," ",s.totalAmount.toFixed(2)]})]})})]})})]})}function P(){const r=d(l=>l.rehearsals),i=d(l=>l.gigs),n=d(l=>l.settings),s=V(r),t=R(i),a=$(i);return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[e.jsx(j,{size:32}),"Analytics & Insights"]}),e.jsx("p",{className:"text-foreground/70",children:"Track your rehearsals, gigs, earnings, and mileage"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(p,{label:"Total Rehearsals",value:s.total.toString(),icon:e.jsx(b,{size:20}),trend:s.upcoming>0?"up":void 0,trendValue:s.upcoming>0?`${s.upcoming} upcoming`:void 0}),e.jsx(p,{label:"Total Gigs",value:t.total.toString(),icon:e.jsx(N,{size:20}),trend:t.upcoming>0?"up":void 0,trendValue:t.upcoming>0?`${t.upcoming} upcoming`:void 0}),e.jsx(p,{label:"Task Completion",value:`${s.totalTasks>0?Math.round(s.completedTasks/s.totalTasks*100):0}%`,icon:e.jsx(b,{size:20}),trend:s.completedTasks>0?"up":void 0,trendValue:s.completedTasks>0?`${s.completedTasks} completed`:void 0}),e.jsx(p,{label:"Gig Status",value:`${t.confirmed} Confirmed`,icon:e.jsx(N,{size:20}),trend:t.pending>0?"neutral":void 0,trendValue:t.pending>0?`${t.pending} pending`:void 0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsx(A,{}),e.jsx(B,{})]}),a.length>0&&e.jsxs("div",{className:"mb-6 p-6 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Top Earning Venues"}),e.jsx("div",{className:"space-y-3",children:a.map((l,c)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/20 text-primary font-bold text-sm",children:c+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-xs text-foreground/50",children:[l.count," gig",l.count!==1?"s":""]})]}),e.jsxs("div",{className:"font-semibold",children:[n.currency," ",l.total.toLocaleString()]})]},l.name))})]}),e.jsx(U,{}),r.length===0&&i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{size:64,className:"mx-auto mb-4 text-foreground/20"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No data yet"}),e.jsx("p",{className:"text-foreground/70 mb-6",children:"Create some rehearsals and gigs to see your analytics"})]})]})}export{P as default};

import{d as I,e as B,r as x,j as e,L as O,k as U,g as P,s as Y}from"./index-DsEjXmEw.js";import{C as $}from"./Card-cX6znXpD.js";import{f as V,B as A}from"./dates-DLBrmLeP.js";import{B as h}from"./Button-DCCwLZlP.js";import{C as H}from"./ConfirmDialog-11iSsLTs.js";import{I as i}from"./Input-C8zBtfFX.js";import{S as J,u as R,a as q}from"./useFormValidation-B9b7cUl7.js";import{M as K}from"./Modal-BW9_-ui1.js";import{T as Q}from"./Textarea-CuJbGIRy.js";const E=["from-purple-500/20 to-pink-500/20","from-blue-500/20 to-cyan-500/20","from-green-500/20 to-emerald-500/20","from-orange-500/20 to-red-500/20","from-indigo-500/20 to-purple-500/20"];function W({gig:a}){const{deleteGig:c}=I(),{settings:u}=B(),[p,l]=x.useState(!1),n=parseInt(a.id.slice(-1),36)%E.length,d=E[n],g=s=>{s.preventDefault(),l(!0)},o=async()=>{await c(a.id),l(!1)},f=()=>{l(!1)},r=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:u.currency||"USD"}).format(s),j={pending:"default",confirmed:"info",completed:"success",cancelled:"error"};return e.jsxs(O,{to:`/gigs/${a.id}`,"data-testid":"gig-card",children:[e.jsxs($,{className:`group hover:scale-[1.02] transition-transform bg-gradient-to-br ${d} relative overflow-hidden`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold truncate mb-1",children:a.venue.name}),e.jsxs("p",{className:"text-sm opacity-80",children:[V(a.date,"EEE, MMM d")," at ",V(a.date,"h:mm a")]}),a.venue.address&&e.jsx("p",{className:"text-xs opacity-60 mt-1 truncate",children:a.venue.address})]}),e.jsx(A,{variant:j[a.status],size:"sm",children:a.status})]}),a.compensation&&e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"px-3 py-1 rounded-full bg-white/10 backdrop-blur-sm",children:e.jsx("span",{className:"text-sm font-medium",children:r(a.compensation.amount)})}),a.compensation.status==="paid"&&e.jsx(A,{variant:"success",size:"sm",children:"Paid"})]}),a.venue.address&&e.jsxs("div",{className:"flex items-center gap-2 text-xs opacity-60 mb-3",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:"Has location"}),a.mileage&&e.jsxs("span",{children:["â€¢ ",a.mileage.toFixed(1)," mi"]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(h,{size:"sm",variant:"danger",onClick:g,className:"w-full","data-testid":"delete-gig-button",children:"Delete"})})]}),e.jsx(H,{open:p,title:"Delete gig?",description:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["This will permanently delete the gig at"," ",e.jsx("strong",{children:a.venue.name}),"."]}),e.jsx("p",{className:"mt-1 text-warning",children:"This action cannot be undone."})]}),confirmLabel:"Delete gig",confirmVariant:"danger",onConfirm:o,onCancel:f})]})}function X({search:a,onSearchChange:c,statusFilter:u,onStatusFilterChange:p}){const l=[{value:"all",label:"All"},{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{type:"search",placeholder:"Search gigs...",value:a,onChange:n=>c(n.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs opacity-60 mb-2 block",children:"Filter by status"}),e.jsx(J,{options:l,value:u,onChange:n=>p(n)})]})]})}function oe(){var y,N,C,S,w,D,G,T,k,M,F;const{gigs:a,loadGigs:c,addGig:u}=I(),{activeModal:p,openModal:l,closeModal:n}=U(),[d,g]=x.useState(""),[o,f]=x.useState("all");x.useEffect(()=>{c()},[c]);const{register:r,handleSubmit:j,formState:{errors:s},reset:L}=R(Y,{defaultValues:{date:"",callTime:"",venue:{name:"",address:"",contact:""},compensation:{amount:0,currency:"USD",status:"pending"},status:"pending",notes:""}}),z=async t=>{const m=Date.now(),v={id:q("gig"),date:t.date,callTime:t.callTime,venue:t.venue,compensation:t.compensation.amount>0?t.compensation:void 0,status:t.status||"pending",notes:t.notes,createdAt:m,updatedAt:m};await u(v),L(),n()},b=x.useMemo(()=>a.filter(t=>{const m=t.venue.name.toLowerCase().includes(d.toLowerCase()),v=o==="all"||t.status===o;return m&&v}).sort((t,m)=>P(t.date,m.date)),[a,d,o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gigs"}),e.jsx(h,{variant:"primary",onClick:()=>l("create-gig"),"data-testid":"new-gig-button",children:"New Gig"})]}),e.jsx(X,{search:d,onSearchChange:g,statusFilter:o,onStatusFilterChange:f}),b.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg opacity-60 mb-4",children:d||o!=="all"?"No gigs match your filters":"No gigs yet. Create your first one!"}),e.jsx(h,{variant:"primary",onClick:()=>l("create-gig"),children:"New Gig"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(t=>e.jsx(W,{gig:t},t.id))}),e.jsx(K,{open:p==="create-gig",onClose:n,title:"Create New Gig",children:e.jsxs("form",{onSubmit:j(z),className:"space-y-4",children:[e.jsx(i,{label:"Venue Name",...r("venue.name"),error:(N=(y=s.venue)==null?void 0:y.name)==null?void 0:N.message,placeholder:"Blue Note Jazz Club"}),e.jsx(i,{label:"Venue Address (optional)",...r("venue.address"),error:(S=(C=s.venue)==null?void 0:C.address)==null?void 0:S.message,placeholder:"123 Main St, New York, NY"}),e.jsx(i,{label:"Venue Contact (optional)",...r("venue.contact"),error:(D=(w=s.venue)==null?void 0:w.contact)==null?void 0:D.message,placeholder:"Email or phone"}),e.jsx(i,{label:"Performance Date & Time",type:"datetime-local",...r("date"),error:(G=s.date)==null?void 0:G.message}),e.jsx(i,{label:"Call Time (optional)",type:"datetime-local",...r("callTime"),error:(T=s.callTime)==null?void 0:T.message}),e.jsx(i,{label:"Compensation Amount (optional)",type:"number",step:"0.01",...r("compensation.amount",{valueAsNumber:!0}),error:(M=(k=s.compensation)==null?void 0:k.amount)==null?void 0:M.message,placeholder:"0.00"}),e.jsx(Q,{label:"Notes (optional)",...r("notes"),error:(F=s.notes)==null?void 0:F.message,placeholder:"Any additional details...",rows:3}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"button",variant:"ghost",onClick:n,className:"flex-1","data-testid":"cancel-create-gig",children:"Cancel"}),e.jsx(h,{type:"submit",variant:"primary",className:"flex-1","data-testid":"submit-create-gig",children:"Create"})]})]})})]})}export{oe as default};
